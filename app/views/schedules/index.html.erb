<% content_for :head do %>
  <%= stylesheet_link_tag "schedules", "data-turbo-track": "reload" %>
  <%= javascript_include_tag "schedules", "data-turbo-track": "reload", defer: true %>
<% end %>

<div class="container">
  <div class="schedule-container">
    
    <!-- スケジュールリスト（左側） -->
    <div class="list-section">
      <div class="card">
        <div class="card-content">
          <div class="schedule-list-header">
            <span class="selected-date">
              <i class="material-icons tiny" style="vertical-align: middle;">event</i>
              <span id="selected-date-text">
                <%= @selected_date.strftime("%Y年%-m月%-d日（#{%w[日 月 火 水 木 金 土][@selected_date.wday]}）") %>のスケジュール
              </span>
            </span>
          </div>
          
          <div id="schedules-list">
            <% if @day_schedules.any? %>
              <ul class="schedules-collection">
                <% @day_schedules.each do |schedule| %>
                  <%= render 'schedule_item', schedule: schedule %>
                <% end %>
              </ul>
            <% else %>
              <div class="schedules-empty-message">
                <i class="material-icons">event_busy</i>
                <p>この日のスケジュールはありません</p>
              </div>
            <% end %>
          </div>
        </div>
        
        <div class="card-action">
          <a href="#modal-add-schedule" class="modal-trigger" style="color: #33b5e5; text-decoration: none; font-weight: 400;">
            <i class="material-icons left">add</i>スケジュールを追加
          </a>
        </div>
      </div>
    </div>

    <!-- カレンダー（右側） -->
    <div class="calendar-section">
      <div class="card calendar-card">
        <div class="calendar-header">
          <%= link_to schedules_path(year: (@month == 1 ? @year - 1 : @year), month: (@month == 1 ? 12 : @month - 1), date: @selected_date), class: "calendar-nav-btn" do %>
            <i class="material-icons">chevron_left</i>
          <% end %>
          <div style="display: flex; align-items: center; gap: 10px;">
            <h5><%= @year %>年<%= @month %>月</h5>
            <%= link_to schedules_path(date: Date.today), class: "today-btn" do %>
              今日
            <% end %>
          </div>
          <%= link_to schedules_path(year: (@month == 12 ? @year + 1 : @year), month: (@month == 12 ? 1 : @month + 1), date: @selected_date), class: "calendar-nav-btn" do %>
            <i class="material-icons">chevron_right</i>
          <% end %>
        </div>
        
        <div class="calendar-body">
          <%= render 'calendar', year: @year, month: @month, selected_date: @selected_date, schedules: @month_schedules %>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 追加モーダル -->
<%= render 'form_modal' %>

<!-- 削除確認モーダル -->
<%= render 'delete_modal' %>

